<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post Details</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>
    <div class="container mt-5">
        <div class="card shadow-sm p-4">
            <h2 id="postTitle">Loading...</h2>
            <p class="text-muted" id="postAuthorDate"></p>
            <img id="postImage" class="img-fluid mb-3" src="" alt="">
            <p><span class="badge bg-primary" id="postCategory"></span></p>
            <hr>
            <p id="postDescription" style="white-space: pre-line;"></p>
        </div>
    </div>


    <!-- SupaBase Library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!--  -->
    <script>
        const supabaseUrl = "https://qmujsllexgevhzpkuygo.supabase.co";
        const supabaseKey = "sb_publishable_4HLArwo3ZhIorJ15ag0K3Q_o0do1Vk2";
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);

        document.addEventListener('DOMContentLoaded', loadPost);

        async function loadPost() {
            const params = new URLSearchParams(window.location.search);
            const postId = params.get('id');

            if (!postId) {
                Swal.fire({ icon: 'error', title: 'Error', text: 'Post ID not found!' });
                return;
            }

            const { data: post, error } = await supabase
                .from('posts')
                .select('*')
                .eq('id', postId)
                .single();

            if (error) {
                Swal.fire({ icon: 'error', title: 'Error', text: error.message });
                return;
            }

            // Populate the post details in the page
            document.getElementById('postTitle').textContent = post.title;
            document.getElementById('postAuthorDate').textContent = `By ${post.author} â€¢ ${new Date(post.created_at).toLocaleDateString()}`;
            document.getElementById('postImage').src = post.image_url || 'img/no-image.png';
            document.getElementById('postImage').alt = post.title;
            document.getElementById('postCategory').textContent = post.category;
            document.getElementById('postDescription').textContent = post.description;

            // You can also make sure the description doesn't get cut off (if needed)
            document.getElementById('postDescription').style.whiteSpace = 'pre-line';
        }
    </script>

</body>

</html>